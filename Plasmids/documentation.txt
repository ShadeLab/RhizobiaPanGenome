NCBI accession numbers were used to fetch Rhizobium plasmid information from ncbi. I have a set of metadata for all 287 Rhizobium genomes with a taxon_oid but I believe I used a smaller set of 264 genomes. The 23 missing will later be used to possibly retrieve more plasmids. The accession numbers were used with an HTML parser in the "html to txt" jupyer notebook in "Plasmids/notebooks". Accession numbers were used to find an organism name and this was used to generate a download link for a table that contained plasmid information for all plasmids associated with the organism name. These were downloaded in "retrieval/genomes_plasmids" then concatenated in "csvs/allplasmids.csv". Data for 276 plasmids of 67 organisms was found this way. 

Plasmids sequences were retrieved using refseq numbers in the allplasmids.csv table. 11 plasmids did not have a refseq ID in their data so they were not retrieved. This removed 2 of the represented organisms from the 67 as all of their plasmids did not have refseq IDs. "Rhizobium favelukesii" had a plasmid not downloaded due to missing refseq information but it had 3 others. Individual sequences were downloaded to "retrieval/plasmids_fastas" then concatenated in "querytests/plasmidquery.txt" without duplicates. 

The full plasmid query of the 265 genomes was blasted against nifH and nodC Rhizobium references. Scores of the highest match were recorded in "csvs/funcpres.csv". Plasmids that did not have any matches to the nifH or nodC references were labeled with a "score" of 0. 50 of the 65 organisms had a single plasmid that matched against both nifH and nodC. These will be considered to be the symbiotic plasmids and well eventually be seperated into their own set. Other organisms had plasmids that matched against only one of the functional genes but not both. More functional gene references will be used to blast with the query to hopefully match with these single match plasmids so they can be more confidentally labeled as the symbiotic plasmid. 

Species identificaition in "csvs/allplasmids.csv" did not have strain type or other further identification to be able to match them with a specific ncbi genome. Using a query of the plasmid's refseq numbers with JGIs metadata retrieval produced organism names with strain types. This was saved in "csvs/nuccore_result.txt". "csvs/plasmidinf.csv" was created to remove the 11 plasmids that were no longer being used. The organisms names in this csv were replaced with the full names with strain information as retrieved from JGI. These names were then used to pair the plasmids and their organisms with the much larger metadata set from JGI "csvs/jgiAllRhizobium.xls". This contains useful information such as country and host name. "csvs/organisminf.csv" was created from plasmidinf.csv and jgiAllRhizobium.xls. It contains all metadata from jgiAllRhizobium for the 65 organisms being used. The organism names seen in plasmidinf.csv as well as am arbitrary number assigned to each organism was added as the first 2 columns in both plasmidinf.csv abd organisminf.csv to easliy compare the two tables and see what organism information in organisminf applies to what plasmids in plasmidinf. This could all be represented in one table easily but it would result in unneeded repition of the organism metadata for each plasmid belonging to the organism and would most likely be difficult to read. Some organisms were not available on JGI and thus could not have metadata retrieved. Information will be retrieved through NCBI but it will be less extensive.


Next steps are - 1) fill in missing organism information with NCBI 2) create references for other functional genes and blast these against plasmid query

The "conversion_functions" notebook used in the previous Rhizobium work will be copied into the plasmids directory to be used with documented functional gene presence. Methods to record the maximum score of each match using blast .out files was added. Genes included in the now added "allfunctionalgenes.xls" file in the csvs directory will be searched on uniprot for references. 
